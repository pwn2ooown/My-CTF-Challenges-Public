# 好駭客的網站 Revenge

好駭客 Vincent 又做了一個有登入介面以及上傳大頭貼的網站作為加入「牛肉湯駭客組織」的入會試煉，你能通過好駭客考驗嗎？

Flag 在 `/flag`，請將它讀出來並提交到平台上。

Author: pwn2ooown & Vincent55

http://chall.nckuctf.org:29106/

## Hint

1. `/images/info.php`
2. `IT.png`

## Notes

- Blackbox
- This is first time I write a website with lots of functions and the code may be ugly, ~~please blame ChatGPT because of the code are generated by it.~~

## Acknowledgement

The idea of this problem is inspired by a challenge created by [CHT Security](https://www.chtsecurity.com/) in 2024 national skills competition. I thought this challenge was really interesting so I want to replicate it. Code is mainly generated by [ChatGPT](https://chatgpt.com) and design of the website is by [Vincent55](https://vincent55.tw/) ~~and AI~~.

## Writeup

- Notice that after some trying we need to bypass mime type and extension check. We can bypass it by using `GIF89a` at the beginning of the file and extension be `.Php` to upload a webshell.

- Another thing we need to bypass is that we cannot execute php in `uploads` directory. We can bypass it by uploading `/var/www/html` directory, but how?

- Notice that each person's avatar is at `uploads/{username}_{original filename}`. If we can control the username, we can control the path. However while registering, we cannot have username that is not alphanumeric. We can bypass it by using `reset password` function since while resetting password, we can set username to anything and it'll register an "invalid" user whose username is path traversal payload like `../images/c`. (images can upload php file)

- The original challenge was on a Windows machine so that the extension is case insensitive so we can upload `.Php` file.

## Deploy

Start: `docker compose up --build`
Stop: `docker compose down -v`
